name: generate-docs

on:
  push:
    branches:
      - main
    paths:
      - "mkdocs.yaml"
      - "**/*.md"
      - "**/*.svg"
      - "**/*.png"
      - "**/*.css"
  pull_request:
    paths:
      - "mkdocs.yaml"
      - "**/*.md"
      - "**/*.svg"
      - "**/*.png"
      - "**/*.css"

jobs:
  get-docs-version-name:
    uses: autowarefoundation/autoware-github-actions/.github/workflows/reusable-get-docs-version-name.yaml@ec4c748cc49333a9067152b045fbc6a8bc0cd231

  generate-docs:
    uses: autowarefoundation/autoware-github-actions/.github/workflows/reusable-generate-docs.yaml@ec4c748cc49333a9067152b045fbc6a8bc0cd231
    needs: get-docs-version-name
    with:
      script-ref: ec4c748cc49333a9067152b045fbc6a8bc0cd231
      mkdocs-yaml: mkdocs.yaml
      version-name: ${{ needs.get-docs-version-name.outputs.version-name }}
    secrets:
      token: ${{ secrets.GITHUB_TOKEN }}
